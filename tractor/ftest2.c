#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#include "mp_fourier.c"

double amps[] = {  1.99485977e-04,   2.61612679e-03,   1.89726655e-02,
                   1.00186544e-01,   3.68534484e-01,   5.09490694e-01 };

double mu0 = -22.41149365;
double mu1 = -24.20769429;

double vars[] = { 3.53418182e-03,   8.54829918e-08,
                  8.54829918e-08,   3.53428174e-03  ,

                  2.60335143e-02,   6.29685399e-07 ,
                  6.29685399e-07,   2.60342503e-02  ,

                  1.15215993e-01,   2.78678581e-06 ,
                  2.78678581e-06,   1.15219250e-01  ,

                  4.11981834e-01,   9.96480700e-06 ,
                  9.96480700e-06,   4.11993482e-01  ,

                  1.35671163e+00,   3.28154508e-05 ,
                  3.28154508e-05,   1.35674999e+00  ,

                  4.41951851e+00,   1.06897065e-04 ,
                  1.06897065e-04,   4.41964346e+00   };

double vv[] = {0.      ,  0.015625,  0.03125 ,  0.046875,  0.0625  ,  0.078125,
               0.09375 ,  0.109375,  0.125   ,  0.140625,  0.15625 ,  0.171875,
               0.1875  ,  0.203125,  0.21875 ,  0.234375,  0.25    ,  0.265625,
               0.28125 ,  0.296875,  0.3125  ,  0.328125,  0.34375 ,  0.359375,
               0.375   ,  0.390625,  0.40625 ,  0.421875,  0.4375  ,  0.453125,
               0.46875 ,  0.484375,  0.5      };
double ww[] = {0.      ,  0.015625,  0.03125 ,  0.046875,  0.0625  ,  0.078125,
               0.09375 ,  0.109375,  0.125   ,  0.140625,  0.15625 ,  0.171875,
               0.1875  ,  0.203125,  0.21875 ,  0.234375,  0.25    ,  0.265625,
               0.28125 ,  0.296875,  0.3125  ,  0.328125,  0.34375 ,  0.359375,
               0.375   ,  0.390625,  0.40625 ,  0.421875,  0.4375  ,  0.453125,
               0.46875 ,  0.484375, -0.5     , -0.484375, -0.46875 , -0.453125,
               -0.4375  , -0.421875, -0.40625 , -0.390625, -0.375   , -0.359375,
               -0.34375 , -0.328125, -0.3125  , -0.296875, -0.28125 , -0.265625,
               -0.25    , -0.234375, -0.21875 , -0.203125, -0.1875  , -0.171875,
               -0.15625 , -0.140625, -0.125   , -0.109375, -0.09375 , -0.078125,
               -0.0625  , -0.046875, -0.03125 , -0.015625 };

int i;
int NV = sizeof(vv) / sizeof(double);
int NW = sizeof(ww) / sizeof(double);
int K  = sizeof(amps) / sizeof(double);

int main() {
    printf("K = %i, NV = %i, NW = %i\n", K, NV, NW);
    double dv = vv[1]-vv[0];
    double dw = dv;
    for (i=0; i<1000; i++) {
        double* f = malloc(sizeof(double) * NV * NW);
        //printf(".");
        //fflush(NULL);
        if (K == 6) {
            //mp_fourier_core(NW, NV, 6, mu0, mu1, vv, ww, amps6, vars, f);
            mp_fourier_core_vw(NW, NV, 6, mu0, mu1,
                               0., dv, -0.5, dw, amps6, vars, f);
        } else {
            mp_fourier_core(NW, NV, K, mu0, mu1, vv, ww, amps, vars, f);
        }
        free(f);
    }
    printf("\n");
}

